{"version":3,"file":"static/js/recent.9b0f3df4.js","sources":["webpack://web/./src/settings.ts","webpack://web/./src/recent.tsx"],"sourcesContent":["import { type Accessor, createSignal } from \"solid-js\";\n\nexport type Settings = {\n  moveColors: boolean;\n  twoDImages: boolean;\n  darkMode: boolean;\n  newFormat: boolean;\n  lastViewedCount: number;\n  lastViewedPacked: string;\n};\n\nexport function initSettings() {\n  const moveColorsString = localStorage.getItem(\"moveColors\");\n  let moveColors = true;\n  if (moveColorsString !== null) {\n    moveColors = JSON.parse(moveColorsString);\n  }\n\n  const twoDImagesString = localStorage.getItem(\"twoDImages\");\n  let twoDImages = false;\n  if (twoDImagesString !== null) {\n    twoDImages = JSON.parse(twoDImagesString);\n  }\n\n  const darkModeString = localStorage.getItem(\"darkMode\");\n  let darkMode = true;\n  if (darkModeString !== null) {\n    darkMode = JSON.parse(darkModeString);\n  }\n\n  const newFormatString = localStorage.getItem(\"newFormat\");\n  let newFormat = false;\n  if (newFormatString !== null) {\n    newFormat = JSON.parse(newFormatString);\n  }\n\n  const lastViewedCountString = localStorage.getItem(\"lastViewedCount\");\n  let lastViewedCount = 20;\n  if (lastViewedCountString !== null) {\n    lastViewedCount = JSON.parse(lastViewedCountString);\n  }\n\n  const lastViewedPackedString = localStorage.getItem(\"lastViewedPacked\");\n  let lastViewedPacked = \"\";\n  if (lastViewedPackedString !== null) {\n    lastViewedPacked = lastViewedPackedString;\n  }\n\n  const initSettings: Settings = {\n    moveColors: moveColors,\n    twoDImages: twoDImages,\n    darkMode: darkMode,\n    newFormat: newFormat,\n    lastViewedCount: lastViewedCount,\n    lastViewedPacked: lastViewedPacked,\n  };\n\n  const [sett, setSett] = createSignal<Settings>(initSettings);\n  return { sett, setSett };\n}\n\nfunction packedToList(packed: string) {\n  const list = packed.split(\"\\n\");\n  return list;\n}\n\nexport type PackedPaste = {\n  id: string;\n  name: string;\n  format: string;\n  pokemon: string[];\n};\n\nexport function getPackedPastes(): PackedPaste[] {\n  const packed = localStorage.getItem(\"lastViewedPacked\");\n  if (packed === null) {\n    return [];\n  }\n  const list: string[] = packedToList(packed);\n  return list.map((item) => {\n    const sections = item.split(\"|\");\n    return {\n      id: sections[0],\n      name: sections[1],\n      format: sections[2],\n      pokemon: sections.slice(3),\n    };\n  });\n}\n\nfunction listToPacked(list: PackedPaste[]): string {\n  let packedString = \"\";\n  for (let i = 0; i < list.length; i++) {\n    if (i > 0) {\n      packedString += \"\\n\";\n    }\n    packedString += `${list[i].id}|${list[i].name}|${list[i].format}`;\n    for (let j = 0; j < list[i].pokemon.length; j++) {\n      packedString += `|${list[i].pokemon[j]}`;\n    }\n  }\n  return packedString;\n}\n\nexport function removePackedPaste(\n  id: string,\n  sett: Accessor<Settings>,\n  setSett: (settings: Settings) => void,\n) {\n  const items = getPackedPastes().filter((item) => item.id !== id);\n  const newPacked = listToPacked(items);\n  localStorage.setItem(\"lastViewedPacked\", newPacked);\n  setSett({ ...sett(), lastViewedPacked: newPacked });\n}\n\nexport function updateSetting(\n  key: string,\n  value: boolean | number | string,\n  sett: Accessor<Settings>,\n  setSett: (settings: Settings) => void,\n) {\n  if (key === \"lastViewedCount\" && typeof value === \"number\") {\n    const list = packedToList(sett().lastViewedPacked);\n    if (value === 0) {\n      setSett({ ...sett(), lastViewedPacked: \"\" });\n    } else {\n      setSett({ ...sett(), lastViewedPacked: list.slice(0, value).join(\"\\n\") });\n    }\n  }\n\n  setSett({ ...sett(), [key]: value });\n  localStorage.setItem(key, JSON.stringify(value));\n}\n","import { createEffect, createSignal, onMount, For, Show } from \"solid-js\";\nimport { render } from \"solid-js/web\";\nimport {\n  initSettings,\n  type PackedPaste,\n  getPackedPastes,\n  removePackedPaste,\n} from \"./settings\";\nimport { Icons } from \"@pkmn/img\";\nimport \"./app.css\";\nimport \"./recent.css\";\n\nfunction updateThemeColor(dark: boolean) {\n  let meta = document.querySelector('meta[name=\"theme-color\"]');\n  if (!meta) {\n    meta = document.createElement(\"meta\");\n    meta.setAttribute(\"name\", \"theme-color\");\n    document.head.appendChild(meta);\n  }\n  meta.setAttribute(\"content\", dark ? \"#000000\" : \"#f9f9f9\");\n}\n\nconst Recent = () => {\n  const { sett: settings, setSett } = initSettings();\n  const [rows, setRows] = createSignal<PackedPaste[]>([]);\n  const [selected, setSelected] = createSignal<Set<string>>(new Set());\n\n  function getPosition(pokemon: string) {\n    const spriteInfo = Icons.getPokemon(pokemon, {\n      protocol: \"https\",\n      domain: \"pokebin.com\",\n    });\n    return `${spriteInfo.left}px ${spriteInfo.top}px`;\n  }\n\n  function handleSelect(id: string, checked: boolean) {\n    setSelected((prev) => {\n      const next = new Set(prev);\n      if (checked) next.add(id);\n      else next.delete(id);\n      return next;\n    });\n  }\n\n  function handleDeleteSelected() {\n    const ids = Array.from(selected());\n    for (const id of ids) {\n      removePackedPaste(id, settings, setSett);\n    }\n    setRows(getPackedPastes());\n    setSelected(new Set<string>());\n  }\n\n  onMount(() => {\n    const dark = settings().darkMode;\n    document.body.classList.toggle(\"dark\", dark);\n    document.body.classList.toggle(\"light\", !dark);\n    updateThemeColor(dark);\n\n    document.title = \"Recent PokeBins\";\n    setRows(getPackedPastes());\n  });\n\n  createEffect(() => {\n    const dark = settings().darkMode;\n    document.body.classList.toggle(\"dark\", dark);\n    document.body.classList.toggle(\"light\", !dark);\n    updateThemeColor(dark);\n  });\n\n  return (\n    <main class=\"min-h-screen flex flex-col items-center bg-[#f9f9f9] dark:bg-zinc-950 transition-colors\">\n      <h1 class=\"text-4xl font-bold mb-4\">\n        Recent <span class=\"text-[#c2a8d4]\">PokeBins</span>\n      </h1>\n      <Show when={rows().length > 0} fallback={<div>No recent pastes.</div>}>\n        <form\n          onSubmit={(e) => {\n            e.preventDefault();\n            handleDeleteSelected();\n          }}\n          class=\"w-full max-w-3xl\"\n        >\n          <table class=\"w-full table-auto border-collapse recent-table\">\n            <thead>\n              <tr>\n                <th class=\"p-2\" />\n                <th class=\"p-2 text-left\">Name</th>\n                <th class=\"p-2 text-left\">Pok√©mon</th>\n                <th class=\"p-2 text-left\">Format</th>\n              </tr>\n            </thead>\n            <tbody>\n              <For each={rows()}>\n                {(row) => (\n                  <tr class=\"border-b border-zinc-200 dark:border-zinc-800\">\n                    <td class=\"p-2 text-center\">\n                      <input\n                        type=\"checkbox\"\n                        checked={selected().has(row.id)}\n                        onInput={(e) =>\n                          handleSelect(row.id, e.currentTarget.checked)\n                        }\n                        aria-label=\"Select for deletion\"\n                      />\n                    </td>\n                    <td class=\"p-2\">\n                      <a\n                        href={`/${row.id}`}\n                        class=\"text-xl font-bold text-[#c2a8d4] hover:underline\"\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                      >\n                        {row.name}\n                      </a>\n                    </td>\n                    <td class=\"p-2\">\n                      <div class=\"flex flex-row gap-1\">\n                        <For each={row.pokemon}>\n                          {(poke) => (\n                            <span\n                              class=\"pokemon-icon\"\n                              title={poke}\n                              style={`background-position: ${getPosition(\n                                poke,\n                              )};`}\n                            />\n                          )}\n                        </For>\n                      </div>\n                    </td>\n                    <td class=\"p-2\">{row.format}</td>\n                  </tr>\n                )}\n              </For>\n            </tbody>\n          </table>\n          <div class=\"mt-4 flex justify-end\">\n            <button\n              type=\"submit\"\n              class=\"px-4 py-2 bg-rose-500 text-white rounded hover:bg-rose-600 disabled:opacity-50\"\n              disabled={selected().size === 0}\n            >\n              Delete Selected\n            </button>\n          </div>\n        </form>\n      </Show>\n    </main>\n  );\n};\n\nconst root = document.getElementById(\"root\");\nif (root) {\n  render(() => <Recent />, root);\n}\n"],"names":["getPackedPastes","packed","localStorage","list","item","sections","updateThemeColor","dark","meta","document","querySelector","createElement","setAttribute","head","appendChild","Recent","_el$","sett","settings","setSett","initSettings","moveColorsString","moveColors","JSON","twoDImagesString","twoDImages","darkModeString","darkMode","newFormatString","newFormat","lastViewedCountString","lastViewedCount","lastViewedPackedString","lastViewedPacked","createSignal","rows","setRows","selected","setSelected","Set","onMount","body","classList","toggle","title","createEffect","_tmpl$2","firstChild","_$insert","_$createComponent","Show","when","length","fallback","_tmpl$3","children","_el$3","_tmpl$","_el$4","_el$6","_el$5","nextSibling","_el$8","_el$7","addEventListener","e","id","preventDefault","Array","from","removePackedPaste","newPacked","listToPacked","packedString","i","j","For","each","row","_el$10","_el$11","_el$12","_el$13","_el$14","_el$15","_el$16","_el$17","_tmpl$4","$$input","checked","currentTarget","prev","next","add","delete","name","pokemon","poke","_el$18","_tmpl$5","_$setAttribute","_$effect","_$p","_$style","getPosition","spriteInfo","Icons","protocol","domain","left","top","format","has","disabled","size","root","getElementById","render","_$delegateEvents"],"mappings":"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"}