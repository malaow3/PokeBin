import{r as me,b as S,d as ye,c as p,o as z,a as xe,t as x,i as d,m as G,u as we,s as $e,F as Q,e as y}from"./app-Dhxd008m.js";var ve=x('<div class="container mx-auto px-4"style=color:white><div class="max-w-3xl mx-auto py-8"><h1 class="text-4xl font-bold mb-4">Fetch <span class=text-[#c2a8d4]>Showdown</span> Private Replays</h1><div class="mb-6 bg-[#c2a8d4] border rounded-lg p-4 text-black"><strong>Privacy Notice:</strong> Your Showdown username and password are <span class=font-semibold>never stored</span> on this site. To fetch your private replays, your credentials must be securely sent to our server, which acts as a proxy to bypass Showdownâ€™s CORS restrictions. All data is transmitted over <span class=font-semibold>encrypted HTTPS</span> and is used only for this request.</div><form class="bg-gray-800 rounded-lg p-6 mb-6 shadow"><div class=mb-4><label class="block mb-1 font-semibold"for=username>Username</label><input id=username class="w-full px-3 py-2 rounded bg-gray-700 text-white"required autocomplete=username></div><div class=mb-4><label class="block mb-1 font-semibold"for=password>Password</label><input id=password type=password class="w-full px-3 py-2 rounded bg-gray-700 text-white"required autocomplete=current-password></div><button type=submit class="bg-[#c2a8d4] hover:bg-[#9770b6] text-black font-bold py-2 px-4 rounded">'),_e=x('<div class="bg-red-700 text-white p-3 rounded mb-4">'),ke=x('<div><div class="flex gap-2 mb-4"><button type=button class="bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-4 rounded">Copy URLs</button><button type=button class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">Uncheck All</button><button type=button class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">Check All</button><button type=button class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">Flip Order</button></div><div class=overflow-x-auto><table class="min-w-full bg-gray-900 rounded-lg"><thead><tr><th class="px-4 py-2 text-left"><input type=checkbox></th><th class="px-4 py-2 text-left">URL</th><th class="px-4 py-2 text-left">Format</th><th class="px-4 py-2 text-left">Player 1</th><th class="px-4 py-2 text-left">Player 2</th><th class="px-4 py-2 text-left">Upload Time</th></tr></thead><tbody>'),Se=x('<tr><td class="px-4 py-2"><input type=checkbox></td><td class="px-4 py-2 break-all"><a target=_blank rel="noopener noreferrer">Link</a></td><td class="px-4 py-2"></td><td class="px-4 py-2">'),Ce=x('<td class="px-4 py-2">');function Re(){const[C,X]=p(""),[R,Z]=p(""),[A,E]=p(!1),[T,ee]=p(null),[a,P]=p([]),[te,se]=p(!0),I=()=>{const e=a();return te()?e:[...e].reverse()},[u,v]=p([]);let h=null;const le=()=>a().map(e=>e.id);function w(){v(le())}function L(){v([])}z(()=>{a().length>0&&w()}),xe(()=>{a().length>0&&w()});function ne(e,s,t){const l=s.id,r=u();let o=[];if(e.shiftKey&&h!==null){const i=Math.min(h,t),$=Math.max(h,t),b=a().slice(i,$+1).map(f=>f.id);r.includes(l)?o=r.filter(f=>!b.includes(f)):o=Array.from(new Set([...r,...b]))}else e.ctrlKey||e.metaKey?(r.includes(l)?o=r.filter(i=>i!==l):o=[...r,l],h=t):(r.includes(l)?o=r.filter(i=>i!==l):o=[...r,l],h=t);v(o)}function re(e){return u().includes(e)}function oe(){return new Promise((e,s)=>{const t=new WebSocket("wss://sim3.psim.us/showdown/websocket");t.onmessage=l=>{const r=l.data.split(`
`);for(const o of r)if(o.startsWith("|challstr|")){const i=o.slice(10);t.close(),e(i)}},t.onerror=l=>{s(new Error("WebSocket error"))},t.onclose=()=>{}})}async function ae(){E(!0),ee(null),P([]);try{const e=await oe(),s=await fetch("/api/fetch-replays",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:C(),pass:R(),challstr:e})});if(!s.ok)throw alert("Unable to fetch replays, please double check your username & password!"),new Error(await s.text());const t=await s.json();P(t)}catch(e){e instanceof Error?console.error(e.message):console.error(String(e))}finally{E(!1)}}function ie(){const e=new Set(u()),s=I().filter(t=>e.has(t.id)).map(t=>{let l=`https://replay.pokemonshowdown.com/${t.id}`;return t.password&&(l+=`-${t.password}pw`),l});navigator.clipboard.writeText(s.join(`
`))}return z(()=>{const e="/ws",s=new WebSocket(e);s.onopen=async()=>{console.log("WebSocket connected to:",e)}}),(()=>{var e=ve(),s=e.firstChild,t=s.firstChild,l=t.nextSibling,r=l.nextSibling,o=r.firstChild,i=o.firstChild,$=i.nextSibling,b=o.nextSibling,f=b.firstChild,F=f.nextSibling,U=b.nextSibling;return r.addEventListener("submit",c=>{c.preventDefault(),ae()}),$.$$input=c=>X(c.currentTarget.value),F.$$input=c=>Z(c.currentTarget.value),d(U,()=>A()?"Loading...":"Fetch Replays"),d(s,(()=>{var c=G(()=>!!T());return()=>c()&&(()=>{var g=_e();return d(g,T),g})()})(),null),d(s,(()=>{var c=G(()=>a().length>0);return()=>c()&&(()=>{var g=ke(),O=g.firstChild,W=O.firstChild,j=W.nextSibling,q=j.nextSibling,ce=q.nextSibling,de=O.nextSibling,pe=de.firstChild,K=pe.firstChild,ue=K.firstChild,he=ue.firstChild,_=he.firstChild,be=K.nextSibling;return W.$$click=ie,j.$$click=L,q.$$click=w,ce.$$click=()=>se(n=>!n),_.addEventListener("change",n=>{n.currentTarget.checked?w():L()}),we(n=>{n.indeterminate=u().length>0&&u().length<a().length},_),d(be,S(Q,{get each(){return I()},fallback:null,children:(n,Ae)=>{let M=`https://replay.pokemonshowdown.com/${n.id}`;n.password&&(M+=`-${n.password}pw`);const fe=a().findIndex(m=>m.id===n.id);return(()=>{var m=Se(),N=m.firstChild,D=N.firstChild,B=N.nextSibling,ge=B.firstChild,H=B.nextSibling,J=H.nextSibling;return D.$$click=k=>ne(k,n,fe),$e(ge,"href",M),d(H,()=>n.format),d(m,S(Q,{get each(){return n.players},fallback:null,children:k=>(()=>{var Y=Ce();return d(Y,k),Y})()}),J),d(J,()=>new Date(n.uploadtime*1e3).toLocaleString()),y(()=>D.checked=re(n.id)),m})()}})),y(()=>_.checked=u().length===a().length),g})()})(),null),y(()=>U.disabled=A()),y(()=>$.value=C()),y(()=>F.value=R()),e})()}const V=document.getElementById("root");V&&me(()=>S(Re,{}),V);ye(["input","click"]);
