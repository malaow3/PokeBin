import{r as ye,b as S,d as me,c as p,o as Y,a as xe,t as x,i as d,m as z,u as we,s as $e,F as G,e as m}from"./app-DFXuq7DK.js";var ve=x('<div class="container mx-auto px-4"><div class="max-w-3xl mx-auto py-8"><h1 class="text-4xl font-bold mb-4">Fetch <span class=text-[#c2a8d4]>Showdown</span> Private Replays</h1><div class="mb-6 bg-[#c2a8d4] border rounded-lg p-4 text-black"><strong>Privacy Notice:</strong> Your Showdown username and password are <span class=font-semibold>never stored</span> on this site. To fetch your private replays, your credentials must be securely sent to our server, which acts as a proxy to bypass Showdownâ€™s CORS restrictions. All data is transmitted over <span class=font-semibold>encrypted HTTPS</span> and is used only for this request.</div><form class="bg-gray-800 rounded-lg p-6 mb-6 shadow"><div class=mb-4><label class="block mb-1 font-semibold"for=username>Username</label><input id=username class="w-full px-3 py-2 rounded bg-gray-700 text-white"required autocomplete=username></div><div class=mb-4><label class="block mb-1 font-semibold"for=password>Password</label><input id=password type=password class="w-full px-3 py-2 rounded bg-gray-700 text-white"required autocomplete=current-password></div><button type=submit class="bg-[#c2a8d4] hover:bg-[#9770b6] text-black font-bold py-2 px-4 rounded">'),_e=x('<div class="bg-red-700 text-white p-3 rounded mb-4">'),ke=x('<div><div class="flex gap-2 mb-4"><button type=button class="bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-4 rounded">Copy URLs</button><button type=button class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">Uncheck All</button><button type=button class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">Check All</button><button type=button class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">Flip Order</button></div><div class=overflow-x-auto><table class="min-w-full bg-gray-900 rounded-lg"><thead><tr><th class="px-4 py-2 text-left"><input type=checkbox></th><th class="px-4 py-2 text-left">URL</th><th class="px-4 py-2 text-left">Format</th><th class="px-4 py-2 text-left">Player 1</th><th class="px-4 py-2 text-left">Player 2</th><th class="px-4 py-2 text-left">Upload Time</th></tr></thead><tbody>'),Se=x('<tr><td class="px-4 py-2"><input type=checkbox></td><td class="px-4 py-2 break-all"><a target=_blank rel="noopener noreferrer">Link</a></td><td class="px-4 py-2"></td><td class="px-4 py-2">'),Ce=x('<td class="px-4 py-2">');function Re(){const[C,V]=p(""),[R,X]=p(""),[A,E]=p(!1),[P,Z]=p(null),[a,T]=p([]),[ee,te]=p(!0),se=()=>{const e=a();return ee()?e:[...e].reverse()},[u,v]=p([]);let h=null;const le=()=>a().map(e=>e.id);function w(){v(le())}function I(){v([])}Y(()=>{a().length>0&&w()}),xe(()=>{a().length>0&&w()});function ne(e,s,t){const l=s.id,r=u();let o=[];if(e.shiftKey&&h!==null){const i=Math.min(h,t),$=Math.max(h,t),b=a().slice(i,$+1).map(f=>f.id);r.includes(l)?o=r.filter(f=>!b.includes(f)):o=Array.from(new Set([...r,...b]))}else e.ctrlKey||e.metaKey?(r.includes(l)?o=r.filter(i=>i!==l):o=[...r,l],h=t):(r.includes(l)?o=r.filter(i=>i!==l):o=[...r,l],h=t);v(o)}function re(e){return u().includes(e)}function oe(){return new Promise((e,s)=>{const t=new WebSocket("wss://sim3.psim.us/showdown/websocket");t.onmessage=l=>{const r=l.data.split(`
`);for(const o of r)if(o.startsWith("|challstr|")){const i=o.slice(10);t.close(),e(i)}},t.onerror=l=>{s(new Error("WebSocket error"))},t.onclose=()=>{}})}async function ae(){E(!0),Z(null),T([]);try{const e=await oe(),s=await fetch("/api/fetch-replays",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:C(),pass:R(),challstr:e})});if(!s.ok)throw alert("Unable to fetch replays, please double check your username & password!"),new Error(await s.text());const t=await s.json();T(t)}catch(e){e instanceof Error?console.error(e.message):console.error(String(e))}finally{E(!1)}}function ie(){const e=new Set(u()),s=a().filter(t=>e.has(t.id)).map(t=>{let l=`https://replay.pokemonshowdown.com/${t.id}`;return t.password&&(l+=`-${t.password}pw`),l});navigator.clipboard.writeText(s.join(`
`))}return Y(()=>{const e="/ws",s=new WebSocket(e);s.onopen=async()=>{console.log("WebSocket connected to:",e)}}),(()=>{var e=ve(),s=e.firstChild,t=s.firstChild,l=t.nextSibling,r=l.nextSibling,o=r.firstChild,i=o.firstChild,$=i.nextSibling,b=o.nextSibling,f=b.firstChild,L=f.nextSibling,F=b.nextSibling;return e.style.setProperty("color","white"),r.addEventListener("submit",c=>{c.preventDefault(),ae()}),$.$$input=c=>V(c.currentTarget.value),L.$$input=c=>X(c.currentTarget.value),d(F,()=>A()?"Loading...":"Fetch Replays"),d(s,(()=>{var c=z(()=>!!P());return()=>c()&&(()=>{var g=_e();return d(g,P),g})()})(),null),d(s,(()=>{var c=z(()=>a().length>0);return()=>c()&&(()=>{var g=ke(),U=g.firstChild,O=U.firstChild,W=O.nextSibling,j=W.nextSibling,ce=j.nextSibling,de=U.nextSibling,pe=de.firstChild,q=pe.firstChild,ue=q.firstChild,he=ue.firstChild,_=he.firstChild,be=q.nextSibling;return O.$$click=ie,W.$$click=I,j.$$click=w,ce.$$click=()=>te(n=>!n),_.addEventListener("change",n=>{n.currentTarget.checked?w():I()}),we(n=>{n.indeterminate=u().length>0&&u().length<a().length},_),d(be,S(G,{get each(){return se()},fallback:null,children:(n,Ae)=>{let K=`https://replay.pokemonshowdown.com/${n.id}`;n.password&&(K+=`-${n.password}pw`);const fe=a().findIndex(y=>y.id===n.id);return(()=>{var y=Se(),M=y.firstChild,N=M.firstChild,D=M.nextSibling,ge=D.firstChild,B=D.nextSibling,H=B.nextSibling;return N.$$click=k=>ne(k,n,fe),$e(ge,"href",K),d(B,()=>n.format),d(y,S(G,{get each(){return n.players},fallback:null,children:k=>(()=>{var J=Ce();return d(J,k),J})()}),H),d(H,()=>new Date(n.uploadtime*1e3).toLocaleString()),m(()=>N.checked=re(n.id)),y})()}})),m(()=>_.checked=u().length===a().length),g})()})(),null),m(()=>F.disabled=A()),m(()=>$.value=C()),m(()=>L.value=R()),e})()}const Q=document.getElementById("root");Q&&ye(()=>S(Re,{}),Q);me(["input","click"]);
